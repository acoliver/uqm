# Phase 05: .rmp Parser Fix — Implementation

## Phase ID
`PLAN-20260224-RES-SWAP.P05`

## Completed
2026-02-24

## Summary
Implemented `parse_propfile()` and `parse_type_path()` replacing `todo!()` stubs
with full working implementations.

## Changes Made

### `rust/src/resource/propfile.rs`
- Implemented `parse_propfile()` following component-001.md pseudocode exactly
- Character-by-character parsing using byte constants (NL, HASH, EQ)
- Handles: leading whitespace, comment lines, inline `#` comments,
  key/value whitespace trimming, bare-key-at-EOF, key-without-value,
  prefix mechanism with 255-char limit
- Uses `log::warn!()` for diagnostic warnings (project convention)
- Removed `#[ignore]` from all 13 P04 propfile tests
- Fixed off-by-one in `test_propfile_real_rmp_content` assertion index

### `rust/src/resource/index.rs`
- Implemented `parse_type_path()` using `split_once(':')`
- Returns `(Some(type_name), rest)` when colon found, `(None, value)` otherwise
- Correctly handles multi-colon values (3DOVID, CONVERSATION)
- Removed `#[ignore]` from all 9 P04 parse_type_path tests

## Verification Results
- `cargo fmt --all --check`: PASS
- `cargo test --lib --all-features`: 1185 passed, 0 failed, 4 ignored (pre-existing)
- `cargo clippy`: no new warnings in changed files
- Deferred pattern grep: 0 matches in propfile.rs and index.rs

## Checklist
- [x] `parse_propfile()` fully implemented (no `todo!()`)
- [x] `parse_type_path()` fully implemented (no `todo!()`)
- [x] Key case preservation confirmed (no `.to_lowercase()` or `.to_uppercase()`)
- [x] Plan/requirement markers present
- [x] All P04 tests pass (GREEN) — 22 previously-ignored tests now active
- [x] Parser handles multi-colon values correctly
- [x] Parser handles inline `#` comments
- [x] Parser handles prefix mechanism with 255-char limit
- [x] Parser handles bare-key-at-EOF and key-without-value edge cases
- [x] No placeholder/deferred implementation patterns remain
