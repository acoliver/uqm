# Phase P11: C Redirect — Implementation (Enable USE_RUST_STATE)

- **Phase ID**: P11
- **Completed**: 2026-02-24
- **Files modified**: `sc2/config_unix.h` — `#define USE_RUST_STATE` is enabled (not commented out)
- **Changes**: USE_RUST_STATE enabled — all 7 state file functions now redirect through Rust FFI
- **Build**: Full build succeeds (`sc2/uqm` binary, 10MB)
- **Rust tests**: 1320 passed, 1 known flaky (test_rust_write_read_state_file — shared global state between parallel tests, passes in isolation), 4 ignored
- **Symbol verification**:
  - `rust_open_state_file`, `rust_close_state_file`, `rust_delete_state_file` linked
  - `rust_length_state_file`, `rust_read_state_file`, `rust_write_state_file` linked
  - `rust_seek_state_file` linked
  - C wrappers (`OpenStateFile` through `SeekStateFile`) present and call Rust
- **FFI signature alignment**: All 7 Rust FFI functions match C extern declarations
  - `int ↔ c_int`, `size_t ↔ usize`, `int64_t ↔ i64`, `void* ↔ *mut u8`, `const void* ↔ *const u8`
